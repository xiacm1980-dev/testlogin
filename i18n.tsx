import React, { createContext, useState, useContext, ReactNode } from 'react';

type Language = 'en' | 'zh';

const translations = {
  en: {
    'app.title': 'Aegis CDR System',
    'app.subtitle': 'Deep Content Disarm & Reconstruction',
    'app.footer': '© 2024 Aegis Security. C++ High Performance Engine.',
    'app.welcome': 'Welcome,',
    
    // Login
    'login.title': 'Login as',
    'login.tab_admin': 'Administrator Login',
    'login.tab_user': 'General User Login',
    'login.general_title': 'General User Login',
    'login.username': 'Username',
    'login.password': 'Password',
    'login.placeholder': 'Enter password (default: 123456)',
    'login.back': 'Back',
    'login.button': 'Login',
    'login.error': 'Invalid password. Default is 123456',
    'login.invalid_creds': 'Invalid username or password.',
    
    // Roles
    'role.sysadmin': 'System Administrator',
    'role.secadmin': 'Security Administrator',
    'role.logadmin': 'Log Audit Administrator',
    'role.user': 'General User',
    'role.desc.sysadmin': 'System status (SQLite), Backup, API Config.',
    'role.desc.secadmin': 'Deep Cleaning Policies, Stream Re-encoding.',
    'role.desc.logadmin': 'Log Audit, Reports & Statistical Analysis.',
    
    // Sidebar
    'menu.dashboard': 'Dashboard',
    'menu.system_config': 'System Config',
    'menu.api_settings': 'API Settings',
    'menu.user_management': 'User Management',
    'menu.security_policies': 'Security Policies',
    'menu.threat_protection': 'Threat & DDoS',
    'menu.video_cleaning': 'Video CDR',
    'menu.file_cleaning': 'File CDR',
    'menu.logs_audit': 'System Log Audit',
    'menu.admin_logs': 'Admin Operation Logs',
    'menu.reports': 'Reports & Analysis',
    'menu.signout': 'Sign Out',
    
    // User Management
    'user.add': 'Add User',
    'user.edit': 'Edit User',
    'user.search': 'Search users...',
    'user.id': 'User ID',
    'user.name': 'Name',
    'user.unit': 'Unit',
    'user.dept': 'Department',
    'user.contact': 'Contact',
    'user.subtitle': 'Manage general user accounts and access.',
    'user.delete_confirm': 'Are you sure you want to delete this user?',

    // Dashboard
    'dash.system_dashboard': 'System Dashboard',
    'dash.cpu': 'CPU Usage',
    'dash.memory': 'Memory Usage',
    'dash.disk': 'Disk Status (SQLite)',
    'dash.uptime': 'System Uptime',
    'dash.healthy': 'Engine Optimal',
    'dash.service_status': 'Service Status',
    'dash.service_name': 'Service Name',
    'dash.status': 'Status',
    'dash.load': 'Load',
    'dash.last_check': 'Last Check',
    'dash.running': 'Running',
    'dash.degraded': 'Degraded',
    'dash.stopped': 'Stopped',
    'dash.task_video': 'Active Stream Tasks',
    'dash.task_file': 'File CDR Tasks',
    'dash.threat_stats': 'Threat & Defense Statistics',
    
    // Stats
    'dash.stat_malware': 'Malware Detected',
    'dash.stat_attacks': 'Total Attacks',
    'dash.stat_rules': 'Active Rules',
    
    // Service Names & Status
    'service.sandbox': 'File Scanning Sandbox',
    'service.video': 'Video Analysis Daemon',
    'service.firewall': 'Core Firewall Engine',
    'service.logs': 'Log Aggregator',
    'status.running': 'Running',
    'status.degraded': 'Degraded',
    'status.stopped': 'Stopped',
    'load.low': 'Low',
    'load.medium': 'Medium',
    'load.high': 'High',
    'time.just_now': 'Just now',
    'time.1_min_ago': '1 min ago',
    'time.5_min_ago': '5 mins ago',

    // System Config
    'config.title': 'System Configuration',
    'config.subtitle': 'Manage C++ engine settings and SQLite persistence.',
    'config.save': 'Save All Changes',
    'config.saving': 'Saving...',
    'config.tab.network': 'Network',
    'config.tab.logs': 'Log Policy',
    'config.tab.backup': 'Backup & Restore',
    'config.network.interfaces': 'Network Interfaces',
    'config.hostname': 'Hostname',
    'config.mgmt_ip': 'Management IP',
    'config.dns': 'DNS Server',
    'config.gateway': 'Gateway',
    'config.time': 'Time & NTP',
    'config.logs.title': 'Log Cleaning & Retention Policy',
    'config.logs.retention': 'Retention Period',
    'config.logs.desc': 'Logs in active DB older than {days} days will be moved to Archive.',
    'config.logs.archive': 'Auto-Archive before delete',
    'config.logs.archive_desc': 'Compress and move old logs to cold storage before deletion.',
    'config.logs.manual': 'Manually Clean Logs Now',
    'config.logs.disk_threshold': 'Archive Cleanup Threshold',
    'config.logs.disk_desc': 'Auto-delete oldest archives when free disk space is below {percent}%.',
    'config.logs.archive_list': 'Archived Log Databases',
    'config.backup.title': 'System Backup & Restore',
    'config.backup.create': 'Create Backup',
    'config.backup.create_desc': 'Package system SQLite DB and Config into a ZIP snapshot.',
    'config.backup.create_btn': 'Create System Snapshot',
    'config.backup.download': 'Download System Snapshot',
    'config.backup.restore': 'Restore System',
    'config.backup.restore_desc': 'Upload a .zip backup to restore system state.',
    'config.backup.upload': 'Click to upload backup file',
    'config.backup.recent': 'Recent Backups',

    // Security Policies
    'policy.title': 'Security Policies',
    'policy.subtitle': 'Manage firewall rules and traffic control lists.',
    'policy.add': 'Add New Rule',
    'policy.search': 'Search policies...',
    'policy.filter': 'Filter',
    'policy.col.status': 'Status',
    'policy.col.id': 'ID',
    'policy.col.name': 'Name',
    'policy.col.source': 'Source',
    'policy.col.dest': 'Destination',
    'policy.col.service': 'Service',
    'policy.col.action': 'Action',
    'policy.allow': 'ALLOW',
    'policy.deny': 'DENY',
    'policy.delete_confirm': 'Are you sure you want to delete this policy rule?',
    'policy.empty': 'No policies found matching your search.',

    // Log Audit
    'log.title.system': 'System Log Audit',
    'log.subtitle.system': 'Security events, file cleaning records, and threat detections.',
    'log.title.admin': 'Admin Operation Logs',
    'log.subtitle.admin': 'Audit trail of administrator actions, logins, and configuration changes.',
    'log.export': 'Export CSV',
    'log.export_modal': 'Export Logs',
    'log.search': 'Search logs...',
    'log.col.time': 'Time',
    'log.col.severity': 'Level',
    'log.col.module': 'Module',
    'log.col.message': 'Content',
    'log.col.source': 'Source/User',
    'log.empty': 'No logs found.',
    'log.level.all': 'ALL',
    'log.level.info': 'INFO',
    'log.level.warn': 'WARN',
    'log.level.error': 'ERROR',
    'log.level.fatal': 'FATAL',
    'log.range.1h': 'Last 1 Hour',
    'log.range.24h': 'Last 24 Hours',
    'log.range.7d': 'Last 7 Days',
    'log.range.30d': 'Last 30 Days',
    'log.range.all': 'All Time',

    // Log Messages (Dynamic)
    'log.msg.login_success': 'User {user} logged in successfully',
    'log.msg.login_fail': 'Failed login attempt for user {user}',
    'log.msg.logout': 'User {user} logged out',
    'log.msg.config_update': 'System configuration updated by {user}',
    'log.msg.policy_add': 'Firewall policy added: {policy}',
    'log.msg.policy_del': 'Firewall policy deleted: ID {id}',
    'log.msg.policy_toggle': 'Firewall policy {id} toggled',
    'log.msg.threat_config': 'Threat protection config updated: SYN={syn}, UDP={udp}',
    'log.msg.whitelist_add': 'IP {ip} added to whitelist',
    'log.msg.whitelist_del': 'IP {ip} removed from whitelist',
    'log.msg.file_clean': 'File cleaned: {file} ({size})',
    'log.msg.file_malware': 'Malware detected and removed: {file}',
    'log.msg.video_stat': 'Video Clean Stats: Port {port} processed {mb}MB',
    'log.msg.threat_block': 'Traffic blocked by rule #{id} ({name})',
    'log.msg.threat_syn': 'SYN Flood detected (PPS: {pps}) - Mitigation Active',
    'log.msg.api_call': 'API Call: {method} {endpoint} - 200 OK',
    'log.msg.system_start': 'Aegis Engine Started. Version 2.4.0',
    'log.msg.backup_create': 'System backup created: {name}',

    // Threat Protection
    'threat.title': 'Threat Protection',
    'threat.subtitle': 'Configure DDoS mitigation and intrusion prevention systems.',
    'threat.active': 'ACTIVE',
    'threat.disabled': 'DISABLED',
    'threat.monitor': 'Live Attack Monitor',
    'threat.pps': 'Current PPS',
    'threat.dropped': 'Dropped Packets',
    'threat.sources': 'Active Sources',
    'threat.mitigating': 'Mitigating',
    'threat.syn_title': 'SYN Flood Protection',
    'threat.syn_desc': 'Limit the rate of SYN packets to prevent connection exhaustion.',
    'threat.threshold': 'Threshold (pps)',
    'threat.action': 'Action',
    'threat.udp_title': 'UDP Flood Protection',
    'threat.udp_desc': 'Mitigate volumetric UDP attacks targeting random ports.',
    'threat.whitelist': 'Trusted IP Whitelist',
    'threat.add_ip': '+ Add IP Range',

    // Video Stream
    'video.title': 'Video Stream CDR',
    'video.subtitle': 'ONVIF/GB28181 Stream Decoding and Re-encoding.',
    'video.restart': 'Restart Engine',
    'video.tab.access': 'Access Config',
    'video.tab.forward': 'Forward Config',
    'video.tab.strategy': 'Cleaning Strategy',
    'video.ingress': 'Ingress Configuration',
    'video.ingress_desc': 'Configure accepted incoming video streams (ONVIF/GB28181).',
    'video.protocol': 'Input Protocol',
    'video.port': 'Listening Port',
    'video.allowed_ips': 'Allowed Source IPs (CIDR)',
    'video.save_ingress': 'Save Ingress Rules',
    'video.forward': 'Forwarding Configuration',
    'video.forward_desc': 'Define where cleaned streams should be sent.',
    'video.strategy': 'Re-encoding Strategy',
    'video.strategy_desc': 'H.264 -> YUV -> Noise Injection -> H.264.',
    'video.check.protocol': 'Re-encode to H.264',
    'video.check.steganography': 'Inject White Noise (Audio/Video)',
    'video.check.framerate': 'Compress Frame Rate',

    // File Cleaning
    'file.title': 'File CDR & Sanitization',
    'file.subtitle': 'Deep cleaning for Office, PDF, Image, and A/V files.',
    'file.drop': 'Drag & Drop files here',
    'file.browse': 'or click to browse from your computer',
    'file.formats': 'Supported: DOC/XLS/PPT, PDF, JPG/PNG, MP4/AVI',
    'file.recent': 'Recent CDR Tasks',
    'file.search': 'Search tasks...',
    'file.col.task': 'Task ID',
    'file.col.filename': 'Filename',
    'file.col.size': 'Size',
    'file.col.status': 'Status',
    'file.col.submitted': 'Submitted',
    'file.col.submitted_by': 'Submitted By',
    'file.status.clean': 'Sanitized',
    'file.status.malicious': 'Threat Removed',
    'file.status.scanning': 'Processing...',
    'file.download': 'Download Clean',
    'file.view_report': 'View Report',
    'file.rule.doc': 'Document CDR',
    'file.rule.doc_desc': 'Convert txt, office, pdf, wps to pure PDF. Strip macros.',
    'file.rule.img': 'Image CDR',
    'file.rule.img_desc': 'Rotate 4x (90°), Sharpen, Resize 95%, Convert to PNG.',
    'file.rule.av': 'A/V CDR',
    'file.rule.av_desc': 'Decode H264/YUV, Frame Compress, Add White Noise, Re-encode.',
    
    // API Settings
    'api.title': 'API Interface Settings',
    'api.subtitle': 'Manage Sync/Async CDR interfaces.',
    'api.rest_title': 'REST API Configuration',
    'api.master_key': 'Master API Key',
    'api.master_key_desc': 'Used for sysadmin level integration. Keep secret.',
    'api.rate_limit': 'Rate Limit (Req/min)',
    'api.timeout': 'Session Timeout (sec)',
    'api.mode': 'Processing Mode',
    'api.mode_desc': 'Support Synchronous and Asynchronous task submission.',
    
    // Reports
    'report.title': 'Reports & Analysis',
    'report.subtitle': 'Generate compliance reports and traffic analysis.',
    'report.export': 'Export Summary',
    'report.audit': 'Monthly Security Audit',
    'report.audit_desc': 'Comprehensive overview of blocked threats, policy changes, and system events.',
    'report.traffic': 'Traffic Analysis',
    'report.traffic_desc': 'Bandwidth usage, top talkers, and protocol distribution charts.',
    'report.compliance': 'Compliance Report',
    'report.compliance_desc': 'ISO 27001 / GDPR compliance check status and violation history.',
    'report.generate': 'Generate Report →',
    'report.history': 'Generated History',
    'report.col.name': 'Report Name',
    'report.col.date': 'Date Range',
    'report.col.by': 'Generated By',
    'report.col.on': 'Generated On',
    
    // Common
    'common.change_password': 'Change Password',
    'common.update_password': 'Update Password',
    'common.cancel': 'Cancel',
    'common.current_password': 'Current Password',
    'common.new_password': 'New Password',
    'common.confirm_password': 'Confirm New Password',
    'common.success': 'Success',
    'common.password_changed': 'Password changed successfully!',
    'common.access_denied': 'Access Denied',
    'common.no_permission': 'Your role does not have permission to view this resource.',
    'common.coming_soon': 'This module is under development.',
  },
  zh: {
    'app.title': 'Aegis CDR 系统',
    'app.subtitle': '深度内容清洗与重构系统',
    'app.footer': '© 2024 Aegis Security. C++ 高性能引擎.',
    'app.welcome': '欢迎，',
    
    // Login
    'login.title': '登录身份',
    'login.tab_admin': '管理员登录',
    'login.tab_user': '一般用户登录',
    'login.general_title': '一般用户登录',
    'login.username': '用户名',
    'login.password': '密码',
    'login.placeholder': '输入密码 (默认: 123456)',
    'login.back': '返回',
    'login.button': '登录',
    'login.error': '密码错误。默认密码为 123456',
    'login.invalid_creds': '用户名或密码错误。',
    
    // Roles
    'role.sysadmin': '系统管理员',
    'role.secadmin': '安全管理员',
    'role.logadmin': '审计管理员',
    'role.user': '一般用户',
    'role.desc.sysadmin': '系统状态 (SQLite), 备份/恢复, API配置',
    'role.desc.secadmin': '深度清洗策略, 流媒体重编码',
    'role.desc.logadmin': '日志审计, 报表与统计分析',
    
    // Sidebar
    'menu.dashboard': '概览',
    'menu.system_config': '系统设置',
    'menu.api_settings': 'API 设置',
    'menu.user_management': '用户管理',
    'menu.security_policies': '安全策略',
    'menu.threat_protection': '威胁与DDoS',
    'menu.video_cleaning': '视频流清洗',
    'menu.file_cleaning': '文件深度清洗',
    'menu.logs_audit': '日志审计',
    'menu.admin_logs': '管理员日志',
    'menu.reports': '报表分析',
    'menu.signout': '退出登录',
    
    // User Management
    'user.add': '添加用户',
    'user.edit': '编辑用户',
    'user.search': '搜索用户...',
    'user.id': '用户ID',
    'user.name': '姓名',
    'user.unit': '单位',
    'user.dept': '部门',
    'user.contact': '联系方式',
    'user.subtitle': '管理一般用户账号和权限。',
    'user.delete_confirm': '确定要删除此用户吗？',

    // Dashboard
    'dash.system_dashboard': '系统概览',
    'dash.cpu': 'CPU 使用率',
    'dash.memory': '内存使用率',
    'dash.disk': '磁盘状态 (SQLite)',
    'dash.uptime': '运行时间',
    'dash.healthy': '引擎正常',
    'dash.service_status': '服务状态',
    'dash.service_name': '服务名称',
    'dash.status': '状态',
    'dash.load': '负载',
    'dash.last_check': '最后检查',
    'dash.running': '运行中',
    'dash.degraded': '降级',
    'dash.stopped': '已停止',
    'dash.task_video': '活跃视频流任务',
    'dash.task_file': '文件CDR任务',
    'dash.threat_stats': '威胁防御统计',
    
    // Stats
    'dash.stat_malware': '恶意代码检测',
    'dash.stat_attacks': '收到攻击次数',
    'dash.stat_rules': '活跃防御规则',

    // Service Names & Status
    'service.sandbox': '文件扫描沙箱 (File Sandbox)',
    'service.video': '视频分析守护进程 (Video Daemon)',
    'service.firewall': '核心防火墙引擎 (Firewall Engine)',
    'service.logs': '日志聚合器 (Log Aggregator)',
    'status.running': '运行中',
    'status.degraded': '性能降级',
    'status.stopped': '已停止',
    'load.low': '低',
    'load.medium': '中',
    'load.high': '高',
    'time.just_now': '刚刚',
    'time.1_min_ago': '1分钟前',
    'time.5_min_ago': '5分钟前',

    // System Config
    'config.title': '系统配置',
    'config.subtitle': '管理 C++ 引擎设置和 SQLite 持久化存储。',
    'config.save': '保存更改',
    'config.saving': '保存中...',
    'config.tab.network': '网络',
    'config.tab.logs': '日志策略',
    'config.tab.backup': '备份与恢复',
    'config.network.interfaces': '网络接口',
    'config.hostname': '主机名',
    'config.mgmt_ip': '管理 IP',
    'config.dns': 'DNS 服务器',
    'config.gateway': '网关',
    'config.time': '时间与 NTP',
    'config.logs.title': '日志清理与保留策略',
    'config.logs.retention': '保留期限 (天)',
    'config.logs.desc': 'SQLite 中超过 {days} 天的日志将被清除。',
    'config.logs.archive': '删除前自动归档',
    'config.logs.archive_desc': '删除前压缩并移动旧日志到冷存储。',
    'config.logs.manual': '立即清理日志',
    'config.logs.disk_threshold': '归档清理阈值',
    'config.logs.disk_desc': '当空闲磁盘空间低于 {percent}% 时，自动删除最旧的归档。',
    'config.logs.archive_list': '归档日志数据库',
    'config.backup.title': '系统备份与恢复',
    'config.backup.create': '创建备份',
    'config.backup.create_desc': '下载系统 SQLite 数据库和配置的完整快照。',
    'config.backup.create_btn': '创建系统快照',
    'config.backup.download': '下载系统快照',
    'config.backup.restore': '恢复系统',
    'config.backup.restore_desc': '上传之前保存的快照以恢复系统状态。',
    'config.backup.upload': '点击上传备份文件',
    'config.backup.recent': '最近备份',

    // Security Policies
    'policy.title': '安全策略',
    'policy.subtitle': '管理防火墙规则和流量控制列表。',
    'policy.add': '添加新规则',
    'policy.search': '搜索策略...',
    'policy.filter': '筛选',
    'policy.col.status': '状态',
    'policy.col.id': 'ID',
    'policy.col.name': '名称',
    'policy.col.source': '源',
    'policy.col.dest': '目的',
    'policy.col.service': '服务',
    'policy.col.action': '动作',
    'policy.allow': '允许',
    'policy.deny': '拒绝',
    'policy.delete_confirm': '确定要删除此策略规则吗？',
    'policy.empty': '未找到匹配的策略。',

    // Log Audit
    'log.title.system': '系统日志审计',
    'log.subtitle.system': '安全事件、文件清洗记录和威胁检测。',
    'log.title.admin': '管理员操作日志',
    'log.subtitle.admin': '管理员行为、登录和配置更改的审计跟踪。',
    'log.export': '导出 CSV',
    'log.export_modal': '导出日志',
    'log.search': '搜索日志...',
    'log.col.time': '时间',
    'log.col.severity': '级别',
    'log.col.module': '模块',
    'log.col.message': '内容',
    'log.col.source': '来源/用户',
    'log.empty': '未找到日志。',
    'log.level.all': '所有',
    'log.level.info': '信息',
    'log.level.warn': '警告',
    'log.level.error': '错误',
    'log.level.fatal': '致命',
    'log.range.1h': '最近1小时',
    'log.range.24h': '最近24小时',
    'log.range.7d': '最近7天',
    'log.range.30d': '最近30天',
    'log.range.all': '全部时间',

    // Log Messages
    'log.msg.login_success': '用户 {user} 登录成功',
    'log.msg.login_fail': '用户 {user} 登录失败',
    'log.msg.logout': '用户 {user} 已登出',
    'log.msg.config_update': '系统配置已由 {user} 更新',
    'log.msg.policy_add': '添加防火墙策略: {policy}',
    'log.msg.policy_del': '删除防火墙策略: ID {id}',
    'log.msg.policy_toggle': '切换防火墙策略 {id} 状态',
    'log.msg.threat_config': '威胁防护配置更新: SYN={syn}, UDP={udp}',
    'log.msg.whitelist_add': 'IP {ip} 添加到白名单',
    'log.msg.whitelist_del': 'IP {ip} 从白名单移除',
    'log.msg.file_clean': '文件清洗完成: {file} ({size})',
    'log.msg.file_malware': '检测并移除恶意代码: {file}',
    'log.msg.video_stat': '视频清洗统计: 端口 {port} 处理了 {mb}MB',
    'log.msg.threat_block': '规则 #{id} ({name}) 拦截了流量',
    'log.msg.threat_syn': '检测到 SYN Flood (PPS: {pps}) - 缓解已激活',
    'log.msg.api_call': 'API 调用: {method} {endpoint} - 200 OK',
    'log.msg.system_start': 'Aegis 引擎已启动。版本 2.4.0',
    'log.msg.backup_create': '系统备份已创建: {name}',

    // Threat Protection
    'threat.title': '威胁防护',
    'threat.subtitle': '配置 DDoS 缓解和入侵防御系统。',
    'threat.active': '已激活',
    'threat.disabled': '已禁用',
    'threat.monitor': '实时攻击监控',
    'threat.pps': '当前 PPS',
    'threat.dropped': '丢弃数据包',
    'threat.sources': '攻击源',
    'threat.mitigating': '清洗中',
    'threat.syn_title': 'SYN Flood 防护',
    'threat.syn_desc': '限制 SYN 数据包速率以防止连接耗尽。',
    'threat.threshold': '阈值 (pps)',
    'threat.action': '动作',
    'threat.udp_title': 'UDP Flood 防护',
    'threat.udp_desc': '缓解针对随机端口的体积型 UDP 攻击。',
    'threat.whitelist': '受信任 IP 白名单',
    'threat.add_ip': '+ 添加 IP 范围',

    // Video Stream
    'video.title': '视频流深度清洗',
    'video.subtitle': 'ONVIF/GB28181 流媒体解码与重编码。',
    'video.restart': '重启引擎',
    'video.tab.access': '接入配置',
    'video.tab.forward': '转发配置',
    'video.tab.strategy': '清洗策略',
    'video.ingress': '接入配置',
    'video.ingress_desc': '配置允许的传入视频流 (ONVIF/GB28181)。',
    'video.protocol': '输入协议',
    'video.port': '监听端口',
    'video.allowed_ips': '允许源 IP (CIDR)',
    'video.save_ingress': '保存接入规则',
    'video.forward': '转发配置',
    'video.forward_desc': '定义清洗后流的发送位置。',
    'video.strategy': '重编码清洗策略',
    'video.strategy_desc': 'H.264 -> YUV -> 注入白噪声 -> H.264。',
    'video.check.protocol': '强制重编码为 H.264',
    'video.check.steganography': '注入微量白噪声 (音/视)',
    'video.check.framerate': '帧率压缩',

    // File Cleaning
    'file.title': '文件深度清洗与重构 (CDR)',
    'file.subtitle': '针对文档、图片、音视频进行深度清洗，去除夹带私货。',
    'file.drop': '拖放文件到此处',
    'file.browse': '或点击从电脑浏览',
    'file.formats': '支持: Office/PDF, JPG/PNG, MP4/AVI 等',
    'file.recent': '最近清洗任务',
    'file.search': '搜索任务...',
    'file.col.task': '任务 ID',
    'file.col.filename': '文件名',
    'file.col.size': '大小',
    'file.col.status': '状态',
    'file.col.submitted': '提交时间',
    'file.col.submitted_by': '提交人',
    'file.status.clean': '已重构',
    'file.status.malicious': '已净化',
    'file.status.scanning': '处理中...',
    'file.download': '下载净化版',
    'file.view_report': '查看报告',
    'file.rule.doc': '文档 CDR',
    'file.rule.doc_desc': '将 txt, office, pdf, wps 等转为纯 PDF，剥离宏与格式夹带。',
    'file.rule.img': '图片 CDR',
    'file.rule.img_desc': '旋转 4 次 (90°)，轻微锐化，缩放至 95%，转为 PNG。',
    'file.rule.av': '音视频 CDR',
    'file.rule.av_desc': 'H264/YUV 解码，帧率压缩，加入白噪声，重新编码为 MP4/MP3。',

    // API Settings
    'api.title': 'API 接口设置',
    'api.subtitle': '管理同步与异步清洗接口。',
    'api.rest_title': 'REST API 配置',
    'api.master_key': '主 API 密钥',
    'api.master_key_desc': '用于系统集成。请保密。',
    'api.rate_limit': '速率限制 (Req/min)',
    'api.timeout': '会话超时 (sec)',
    'api.mode': '处理模式',
    'api.mode_desc': '支持同步等待返回和异步任务提交。',
    
    // Reports
    'report.title': '报表与分析',
    'report.subtitle': '生成合规性报告和流量分析。',
    'report.export': '导出摘要',
    'report.audit': '月度安全审计',
    'report.audit_desc': '拦截威胁、策略变更和系统事件的综合概览。',
    'report.traffic': '流量分析',
    'report.traffic_desc': '带宽使用、主要通话者和协议分布图表。',
    'report.compliance': '合规性报告',
    'report.compliance_desc': 'ISO 27001 / GDPR 合规性检查状态和违规记录。',
    'report.generate': '生成报表',
    'report.history': '生成历史',
    'report.col.name': '报表名称',
    'report.col.date': '日期范围',
    'report.col.by': '生成者',
    'report.col.on': '生成时间',
    
    // Common
    'common.change_password': '修改密码',
    'common.update_password': '更新密码',
    'common.cancel': '取消',
    'common.current_password': '当前密码',
    'common.new_password': '新密码',
    'common.confirm_password': '确认新密码',
    'common.success': '成功',
    'common.password_changed': '密码修改成功！',
    'common.access_denied': '访问被拒绝',
    'common.no_permission': '您的角色没有权限查看此资源。',
    'common.coming_soon': '此模块正在开发中。',
  }
};

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string, params?: Record<string, string | number>) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>('zh'); 

  const t = (key: string, params?: Record<string, string | number>) => {
    let text = translations[language][key as keyof typeof translations['en']] || key;
    if (params) {
      Object.entries(params).forEach(([k, v]) => {
        text = text.replace(`{${k}}`, String(v));
      });
    }
    return text;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};